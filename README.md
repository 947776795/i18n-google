# i18n-google

ä¸€ä¸ªæ™ºèƒ½çš„å›½é™…åŒ–è‡ªåŠ¨åŒ–å·¥å…·ï¼Œæ”¯æŒä»£ç è½¬æ¢ã€Google Sheets é›†æˆå’Œæ¨¡å—åŒ–ç¿»è¯‘ç®¡ç†ã€‚

## ğŸš€ æ ¸å¿ƒç‰¹æ€§

### è‡ªåŠ¨åŒ–ä»£ç è½¬æ¢

- ğŸ”„ **æ™ºèƒ½æ–‡æœ¬è¯†åˆ«**ï¼šè‡ªåŠ¨è¯†åˆ«éœ€è¦å›½é™…åŒ–çš„æ–‡æœ¬å†…å®¹
- ğŸ¯ **å¤šç§å¤„ç†æ¨¡å¼**ï¼šæ”¯æŒæ ‡è®°ç¬¦å·æ¨¡å¼å’Œ JSX çº¯æ–‡æœ¬æ¨¡å¼
- ğŸ”§ **AST çº§åˆ«è½¬æ¢**ï¼šä½¿ç”¨ jscodeshift è¿›è¡Œç²¾ç¡®çš„ä»£ç è½¬æ¢
- ğŸ“¦ **è‡ªåŠ¨å¯¼å…¥ç®¡ç†**ï¼šæ™ºèƒ½æ·»åŠ å’Œç®¡ç† I18n ç›¸å…³å¯¼å…¥

### æ¨¡å—åŒ–ç¿»è¯‘ç³»ç»Ÿ

- ğŸ“ **æ¨¡å—åŒ–æ–‡ä»¶ç»“æ„**ï¼šæŒ‰ç»„ä»¶/é¡µé¢ç»„ç»‡ç¿»è¯‘æ–‡ä»¶
- ğŸ”‘ **åŸæ–‡æ¡ˆä½œä¸º Key**ï¼šæé«˜å¯è¯»æ€§å’Œç»´æŠ¤æ€§
- ğŸŒ **å¤šè¯­è¨€æ”¯æŒ**ï¼šæ”¯æŒä»»æ„æ•°é‡çš„ç›®æ ‡è¯­è¨€
- ğŸ“Š **å®Œæ•´è®°å½•ç®¡ç†**ï¼šç»´æŠ¤ç¿»è¯‘çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸè®°å½•

### æ™ºèƒ½é”®ç®¡ç†

- ğŸ§¹ **æ™ºèƒ½æ¸…ç†**ï¼šè‡ªåŠ¨æ£€æµ‹å’Œæ¸…ç†æœªä½¿ç”¨çš„ç¿»è¯‘é”®
- â° **æ—¶é—´åŸºç¡€æ£€æµ‹**ï¼šæ”¯æŒåŸºäºæ—¶é—´çš„è¿‡æœŸé”®æ£€æµ‹
- ğŸ›¡ï¸ **å®‰å…¨ä¿æŠ¤**ï¼šå¼ºåˆ¶ä¿ç•™å…³é”®ç³»ç»Ÿé”®ï¼Œé˜²æ­¢è¯¯åˆ 
- ğŸ’¾ **å¤‡ä»½æ¢å¤**ï¼šåˆ é™¤å‰è‡ªåŠ¨å¤‡ä»½ï¼Œæ”¯æŒä¸€é”®æ¢å¤

### Google Sheets é›†æˆ

- â˜ï¸ **åŒå‘åŒæ­¥**ï¼šä¸ Google Sheets è¿›è¡ŒåŒå‘ç¿»è¯‘åŒæ­¥
- ğŸ”„ **å¢é‡æ›´æ–°**ï¼šæ™ºèƒ½åˆå¹¶è¿œç¨‹å’Œæœ¬åœ°ç¿»è¯‘æ•°æ®
- ğŸ“ˆ **å®æ—¶åä½œ**ï¼šæ”¯æŒå›¢é˜Ÿåä½œç¿»è¯‘ç®¡ç†

### ç”¨æˆ·ä½“éªŒ

- ğŸ’¬ **äº¤äº’å¼ç•Œé¢**ï¼šå‹å¥½çš„å‘½ä»¤è¡Œäº¤äº’ä½“éªŒ
- ğŸ“Š **è¿›åº¦æ˜¾ç¤º**ï¼šå®æ—¶æ˜¾ç¤ºæ“ä½œè¿›åº¦å’Œè¯¦ç»†æŠ¥å‘Š
- ğŸ›ï¸ **çµæ´»é…ç½®**ï¼šä¸°å¯Œçš„é…ç½®é€‰é¡¹æ»¡è¶³ä¸åŒéœ€æ±‚
- ğŸ“ **è¯¦ç»†æ—¥å¿—**ï¼šæ”¯æŒå¤šçº§åˆ«æ—¥å¿—è¾“å‡º

## ğŸ“‹ ç³»ç»Ÿæ¶æ„

### æ ¸å¿ƒç»„ä»¶

```
src/
â”œâ”€â”€ core/                    # æ ¸å¿ƒæœåŠ¡å±‚
â”‚   â”œâ”€â”€ I18nScanner.ts      # ä¸»æ‰«æå™¨ - åè°ƒæ•´ä¸ªæµç¨‹
â”‚   â”œâ”€â”€ FileScanner.ts      # æ–‡ä»¶æ‰«æå™¨ - é€’å½’æ‰«æé¡¹ç›®æ–‡ä»¶
â”‚   â”œâ”€â”€ FileTransformer.ts  # æ–‡ä»¶è½¬æ¢å™¨ - ä»£ç è½¬æ¢å’Œå¼•ç”¨æ”¶é›†
â”‚   â”œâ”€â”€ AstTransformer.ts   # AST è½¬æ¢å™¨ - åº•å±‚ AST æ“ä½œ
â”‚   â”œâ”€â”€ TranslationManager.ts # ç¿»è¯‘ç®¡ç†å™¨ - ç¿»è¯‘æ–‡ä»¶å’Œè®°å½•ç®¡ç†
â”‚   â”œâ”€â”€ GoogleSheetsSync.ts # Google Sheets åŒæ­¥å™¨
â”‚   â”œâ”€â”€ UnusedKeyAnalyzer.ts # æ— ç”¨é”®åˆ†æå™¨ - æ£€æµ‹è¿‡æœŸå’Œæœªä½¿ç”¨çš„é”®
â”‚   â”œâ”€â”€ DeleteService.ts    # åˆ é™¤æœåŠ¡ - å¤„ç†é”®åˆ é™¤é€»è¾‘
â”‚   â””â”€â”€ PreviewFileService.ts # é¢„è§ˆæ–‡ä»¶æœåŠ¡ - ç”Ÿæˆåˆ é™¤é¢„è§ˆ
â”œâ”€â”€ ui/                     # ç”¨æˆ·ç•Œé¢å±‚
â”‚   â”œâ”€â”€ ProgressIndicator.ts # è¿›åº¦æŒ‡ç¤ºå™¨
â”‚   â””â”€â”€ UserInteraction.ts  # ç”¨æˆ·äº¤äº’å¤„ç†
â”œâ”€â”€ utils/                  # å·¥å…·å±‚
â”‚   â”œâ”€â”€ StringUtils.ts      # å­—ç¬¦ä¸²å¤„ç†å’Œæ—¥å¿—å·¥å…·
â”‚   â”œâ”€â”€ AstUtils.ts         # AST å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ PathUtils.ts        # è·¯å¾„å¤„ç†å·¥å…·
â”œâ”€â”€ errors/                 # é”™è¯¯å¤„ç†
â”‚   â””â”€â”€ I18nError.ts        # è‡ªå®šä¹‰é”™è¯¯ç±»å‹
â””â”€â”€ types.ts                # TypeScript ç±»å‹å®šä¹‰
```

### æ ¸å¿ƒæµç¨‹å›¾

```mermaid
flowchart TD
    A[ğŸš€ å¼€å§‹æ‰«æ] --> B[âš™ï¸ åŠ è½½é…ç½®æ–‡ä»¶]
    B --> C[ğŸ“Š è®¾ç½®æ—¥å¿—çº§åˆ«]
    C --> D[ğŸ”„ ä»è¿œç«¯æ‹‰å–ç¿»è¯‘æ•°æ®]
    D --> E[ğŸ“‹ åˆå¹¶åˆ°æœ¬åœ°å®Œæ•´è®°å½•]
    E --> F[ğŸ”§ åˆå§‹åŒ–ç¿»è¯‘ç®¡ç†å™¨]
    F --> G[ğŸ“ æ‰«æé¡¹ç›®æ–‡ä»¶]
    G --> H[ğŸ” å¹¶è¡Œå¤„ç†æ–‡ä»¶]

    subgraph "æ–‡ä»¶å¤„ç†é˜¶æ®µ"
        H --> I[ğŸ“– æ”¶é›†ç°æœ‰ I18n.t() å¼•ç”¨]
        H --> J[ğŸ”„ è½¬æ¢æ ‡è®°æ–‡æœ¬ä¸º I18n.t()]
        H --> K[ğŸ“ è½¬æ¢ JSX çº¯æ–‡æœ¬]
        I --> L[ğŸ”— åˆå¹¶æ‰€æœ‰å¼•ç”¨æ•°æ®]
        J --> L
        K --> L
    end

    L --> M[ğŸ•’ æ›´æ–°å¼•ç”¨æ—¶é—´æˆ³]
    M --> N[ğŸ” æ£€æµ‹æ— ç”¨é”®]
    N --> O{å‘ç°æ— ç”¨é”®?}

    O -->|æ˜¯| P[ğŸ“„ ç”Ÿæˆåˆ é™¤é¢„è§ˆæ–‡ä»¶]
    P --> Q[ğŸ’¬ ç”¨æˆ·ç¡®è®¤åˆ é™¤]
    Q --> R{ç”¨æˆ·ç¡®è®¤?}
    R -->|æ˜¯| S[ğŸ—‘ï¸ æ‰§è¡Œé”®åˆ é™¤]
    R -->|å¦| T[ğŸ“ ä¿ç•™æ— ç”¨é”®]

    O -->|å¦| U[ğŸ“‹ ç”Ÿæˆæ¨¡å—åŒ–ç¿»è¯‘æ–‡ä»¶]
    S --> V[ğŸ”„ æ›´æ–°å®Œæ•´è®°å½•]
    T --> V
    V --> U

    U --> W[ğŸ’¬ ç”¨æˆ·ç¡®è®¤è¿œç«¯åŒæ­¥]
    W --> X{åŒæ­¥åˆ°è¿œç«¯?}
    X -->|æ˜¯| Y[â˜ï¸ æ¨é€åˆ° Google Sheets]
    X -->|å¦| Z[â­ï¸ è·³è¿‡è¿œç«¯åŒæ­¥]

    Y --> AA[ğŸ§¹ æ¸…ç†ä¸´æ—¶æ–‡ä»¶]
    Z --> AA
    AA --> BB[ğŸ“Š æ˜¾ç¤ºæ‰«ææ‘˜è¦]
    BB --> CC[âœ… æ‰«æå®Œæˆ]

    style A fill:#e3f2fd,stroke:#1976d2,stroke-width:3px
    style CC fill:#c8e6c9,stroke:#388e3c,stroke-width:3px
    style P fill:#fff3e0,stroke:#f57c00,stroke-width:2px
    style S fill:#ffebee,stroke:#d32f2f,stroke-width:2px
    style Y fill:#e8f5e8,stroke:#388e3c,stroke-width:2px
```

### å®Œæ•´æ—¶åºå›¾

```mermaid
sequenceDiagram
    participant User as ğŸ‘¤ ç”¨æˆ·
    participant CLI as ğŸ–¥ï¸ CLIç•Œé¢
    participant Scanner as ğŸ” I18nScanner
    participant FileScanner as ğŸ“ FileScanner
    participant FileTransformer as ğŸ”„ FileTransformer
    participant TranslationManager as ğŸ“‹ TranslationManager
    participant GoogleSheets as â˜ï¸ Google Sheets
    participant DeleteService as ğŸ—‘ï¸ DeleteService
    participant UserInteraction as ğŸ’¬ UserInteraction

    User->>CLI: æ‰§è¡Œ i18n-google å‘½ä»¤
    CLI->>Scanner: åˆ›å»ºæ‰«æå™¨å®ä¾‹

    Note over Scanner: ğŸš€ å¼€å§‹æ‰«ææµç¨‹
    Scanner->>Scanner: åŠ è½½é…ç½®æ–‡ä»¶
    Scanner->>Scanner: è®¾ç½®æ—¥å¿—çº§åˆ«

    Note over Scanner,GoogleSheets: â˜ï¸ è¿œç«¯æ•°æ®åŒæ­¥é˜¶æ®µ
    Scanner->>GoogleSheets: æ‹‰å–è¿œç¨‹ç¿»è¯‘æ•°æ®
    GoogleSheets-->>Scanner: è¿”å›è¿œç¨‹å®Œæ•´è®°å½•
    Scanner->>TranslationManager: åˆå¹¶è¿œç¨‹æ•°æ®åˆ°æœ¬åœ°

    Note over Scanner,FileTransformer: ğŸ“ æ–‡ä»¶æ‰«æå’Œå¤„ç†é˜¶æ®µ
    Scanner->>TranslationManager: åˆå§‹åŒ–ç¿»è¯‘ç®¡ç†å™¨
    Scanner->>FileScanner: æ‰«æé¡¹ç›®æ–‡ä»¶
    FileScanner-->>Scanner: è¿”å›æ–‡ä»¶åˆ—è¡¨

    loop å¤„ç†æ¯ä¸ªæ–‡ä»¶
        Scanner->>FileTransformer: åˆ†æå’Œè½¬æ¢æ–‡ä»¶
        FileTransformer->>FileTransformer: æ”¶é›†ç°æœ‰ I18n.t() å¼•ç”¨
        FileTransformer->>FileTransformer: è½¬æ¢æ ‡è®°æ–‡æœ¬
        FileTransformer->>FileTransformer: è½¬æ¢ JSX çº¯æ–‡æœ¬
        FileTransformer-->>Scanner: è¿”å›å¼•ç”¨å’Œè½¬æ¢ç»“æœ
    end

    Scanner->>Scanner: æ›´æ–°å¼•ç”¨æ—¶é—´æˆ³

    Note over Scanner,DeleteService: ğŸ§¹ æ— ç”¨é”®æ£€æµ‹å’Œåˆ é™¤é˜¶æ®µ
    Scanner->>DeleteService: æ£€æµ‹æ— ç”¨é”®å¹¶ç”Ÿæˆè®°å½•
    DeleteService->>TranslationManager: åŠ è½½ç°æœ‰å®Œæ•´è®°å½•
    DeleteService->>DeleteService: åˆ†ææ— ç”¨é”®

    alt å‘ç°æ— ç”¨é”®
        DeleteService->>DeleteService: ç”Ÿæˆåˆ é™¤é¢„è§ˆæ–‡ä»¶
        DeleteService->>UserInteraction: è¯·æ±‚ç”¨æˆ·ç¡®è®¤åˆ é™¤
        UserInteraction->>User: æ˜¾ç¤ºåˆ é™¤é¢„è§ˆ
        User-->>UserInteraction: ç¡®è®¤æˆ–å–æ¶ˆ

        alt ç”¨æˆ·ç¡®è®¤åˆ é™¤
            DeleteService->>TranslationManager: æ‰§è¡Œé”®åˆ é™¤
            DeleteService->>DeleteService: æ›´æ–°å®Œæ•´è®°å½•
        else ç”¨æˆ·å–æ¶ˆåˆ é™¤
            DeleteService->>TranslationManager: ä¿ç•™æ— ç”¨é”®
        end
    else æ— æ— ç”¨é”®
        DeleteService->>TranslationManager: ç›´æ¥æ›´æ–°è®°å½•
    end

    DeleteService-->>Scanner: è¿”å›å¤„ç†åçš„è®°å½•

    Note over Scanner,TranslationManager: ğŸ“‹ ç¿»è¯‘æ–‡ä»¶ç”Ÿæˆé˜¶æ®µ
    Scanner->>TranslationManager: ç”Ÿæˆæ¨¡å—åŒ–ç¿»è¯‘æ–‡ä»¶
    TranslationManager->>TranslationManager: æŒ‰æ¨¡å—è·¯å¾„åˆ†ç»„
    TranslationManager->>TranslationManager: ç”Ÿæˆ TypeScript ç¿»è¯‘æ–‡ä»¶

    Note over Scanner,GoogleSheets: â˜ï¸ è¿œç«¯åŒæ­¥ç¡®è®¤é˜¶æ®µ
    Scanner->>UserInteraction: è¯·æ±‚è¿œç«¯åŒæ­¥ç¡®è®¤
    UserInteraction->>User: è¯¢é—®æ˜¯å¦åŒæ­¥åˆ°è¿œç«¯
    User-->>UserInteraction: ç¡®è®¤æˆ–è·³è¿‡

    alt ç”¨æˆ·ç¡®è®¤åŒæ­¥
        Scanner->>GoogleSheets: æ¨é€å®Œæ•´è®°å½•åˆ°è¿œç«¯
        GoogleSheets-->>Scanner: åŒæ­¥å®Œæˆç¡®è®¤
    else ç”¨æˆ·è·³è¿‡åŒæ­¥
        Scanner->>Scanner: è®°å½•è·³è¿‡åŒæ­¥
    end

    Note over Scanner: ğŸ§¹ æ¸…ç†å’Œå®Œæˆé˜¶æ®µ
    Scanner->>DeleteService: æ¸…ç†ä¸´æ—¶é¢„è§ˆæ–‡ä»¶
    Scanner->>UserInteraction: æ˜¾ç¤ºæ‰«ææ‘˜è¦
    UserInteraction->>User: å±•ç¤ºç»Ÿè®¡ä¿¡æ¯

    Scanner-->>CLI: æ‰«æå®Œæˆ
    CLI-->>User: è¿”å›æ‰§è¡Œç»“æœ

    Note over User,UserInteraction: ğŸ“Š æ‰«ææ‘˜è¦ä¿¡æ¯
    Note right of User: â€¢ å¤„ç†æ–‡ä»¶æ•°é‡<br/>â€¢ ç¿»è¯‘é”®æ€»æ•°<br/>â€¢ æ–°å¢é”®æ•°é‡<br/>â€¢ åˆ é™¤é”®æ•°é‡<br/>â€¢ æ‰§è¡Œæ—¶é•¿
```

## âš™ï¸ é…ç½®è¯´æ˜

åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º `i18n.config.js` é…ç½®æ–‡ä»¶ï¼š

```javascript
module.exports = {
  // åŸºç¡€é…ç½®
  rootDir: "./src", // æ‰«ææ ¹ç›®å½•
  outputDir: "./src/translate", // ç¿»è¯‘æ–‡ä»¶è¾“å‡ºç›®å½•
  languages: ["en", "zh-CN", "zh-TC", "ko", "es", "tr", "de", "vi"],

  // æ–‡ä»¶å¤„ç†é…ç½®
  include: ["js", "jsx", "ts", "tsx"], // åŒ…å«çš„æ–‡ä»¶ç±»å‹
  ignore: [
    // å¿½ç•¥çš„æ–‡ä»¶/ç›®å½•
    "**/test/**",
    "**/node_modules/**",
    "**/*.test.*",
  ],

  // æ ‡è®°ç¬¦å·é…ç½®
  startMarker: "~", // å¼€å§‹æ ‡è®°ç¬¦å·
  endMarker: "~", // ç»“æŸæ ‡è®°ç¬¦å·

  // Google Sheets é…ç½®
  spreadsheetId: "your-google-sheet-id",
  sheetName: "translations",
  keyFile: "./serviceAccountKeyFile.json",
  apiKey: "your-google-api-key",
  sheetsReadRange: "A1:Z10000", // è¯»å–èŒƒå›´

  // é”®ç®¡ç†é…ç½®
  forceKeepKeys: {
    // å¼ºåˆ¶ä¿ç•™çš„é”®ï¼ˆæŒ‰æ¨¡å—ï¼‰
    "src/components/Header": ["system.title"],
    "src/pages/error": ["error.network", "error.timeout"],
  },
  keyExpirationDays: 30, // é”®è¿‡æœŸå¤©æ•°ï¼ˆå¯é€‰ï¼‰

  // ç³»ç»Ÿé…ç½®
  logLevel: "normal", // æ—¥å¿—çº§åˆ«: silent, normal, verbose
};
```

### é…ç½®é€‰é¡¹è¯¦è§£

| é…ç½®é¡¹              | ç±»å‹         | è¯´æ˜                        | é»˜è®¤å€¼      |
| ------------------- | ------------ | --------------------------- | ----------- |
| `rootDir`           | string       | æ‰«æçš„æ ¹ç›®å½•è·¯å¾„            | -           |
| `outputDir`         | string       | ç¿»è¯‘æ–‡ä»¶è¾“å‡ºç›®å½•            | -           |
| `languages`         | string[]     | æ”¯æŒçš„è¯­è¨€ä»£ç åˆ—è¡¨          | -           |
| `include`           | string[]     | åŒ…å«çš„æ–‡ä»¶æ‰©å±•å            | -           |
| `ignore`            | string[]     | å¿½ç•¥çš„æ–‡ä»¶/ç›®å½•æ¨¡å¼         | -           |
| `startMarker`       | string       | æ–‡æœ¬å¼€å§‹æ ‡è®°ç¬¦å·            | -           |
| `endMarker`         | string       | æ–‡æœ¬ç»“æŸæ ‡è®°ç¬¦å·            | -           |
| `spreadsheetId`     | string       | Google Sheets æ–‡æ¡£ ID       | -           |
| `sheetName`         | string       | å·¥ä½œè¡¨åç§°                  | -           |
| `keyFile`           | string       | Google æœåŠ¡è´¦å·å¯†é’¥æ–‡ä»¶è·¯å¾„ | -           |
| `apiKey`            | string       | Google API å¯†é’¥             | -           |
| `sheetsReadRange`   | string       | Google Sheets è¯»å–èŒƒå›´      | "A1:Z10000" |
| `forceKeepKeys`     | object/array | å¼ºåˆ¶ä¿ç•™çš„é”®é…ç½®            | -           |
| `keyExpirationDays` | number       | é”®è¿‡æœŸå¤©æ•°ï¼ˆå¯ç”¨æ—¶é—´æ£€æµ‹ï¼‰  | undefined   |
| `logLevel`          | string       | æ—¥å¿—çº§åˆ«                    | "normal"    |

## ğŸ”§ å¤„ç†æ¨¡å¼

### 1. æ ‡è®°ç¬¦å·æ¨¡å¼

é€‚ç”¨äºå­—ç¬¦ä¸²å­—é¢é‡å’Œæ¨¡æ¿å­—ç¬¦ä¸²ï¼š

```javascript
// é…ç½®
startMarker: "~";
endMarker: "~";

// ä½¿ç”¨ç¤ºä¾‹
const message = "~Hello World~";
const template = `~Welcome ${user.name}!~`;
const attr = <div title="~Click me~">Content</div>;

// è½¬æ¢å
const message = I18n.t("Hello World");
const template = I18n.t("Welcome %{var0}!", { var0: user.name });
const attr = <div title={I18n.t("Click me")}>Content</div>;
```

### 2. JSX çº¯æ–‡æœ¬æ¨¡å¼

è‡ªåŠ¨å¤„ç† JSX å…ƒç´ ä¸­çš„çº¯æ–‡æœ¬ï¼š

```jsx
// åŸå§‹ä»£ç 
function Component() {
  return (
    <div>
      Welcome to our app {/* è‡ªåŠ¨è½¬æ¢ */}
      <p>Get started now</p> {/* è‡ªåŠ¨è½¬æ¢ */}
      <span>{"~Marked text~"}</span> {/* æ ‡è®°æ¨¡å¼ */}
    </div>
  );
}

// è½¬æ¢å
function Component() {
  return (
    <div>
      {I18n.t("Welcome to our app")}
      <p>{I18n.t("Get started now")}</p>
      <span>{I18n.t("Marked text")}</span>
    </div>
  );
}
```

## ğŸ“ æ¨¡å—åŒ–ç¿»è¯‘ç³»ç»Ÿ

### æ–‡ä»¶ç»“æ„

```
src/translate/
â”œâ”€â”€ i18n-complete-record.json          # å®Œæ•´ç¿»è¯‘è®°å½•
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ Header/
â”‚   â”‚   â”‚   â””â”€â”€ index.ts               # Header ç»„ä»¶ç¿»è¯‘
â”‚   â”‚   â””â”€â”€ Button/
â”‚   â”‚       â””â”€â”€ index.ts               # Button ç»„ä»¶ç¿»è¯‘
â”‚   â””â”€â”€ pages/
â”‚       â”œâ”€â”€ home/
â”‚       â”‚   â””â”€â”€ index.ts               # é¦–é¡µç¿»è¯‘
â”‚       â””â”€â”€ about/
â”‚           â””â”€â”€ index.ts               # å…³äºé¡µç¿»è¯‘
â””â”€â”€ const/
    â””â”€â”€ const.ts                       # å¸¸é‡ç¿»è¯‘
```

### ç¿»è¯‘æ–‡ä»¶æ ¼å¼

```typescript
// src/translate/src/components/Header/index.ts
const translations = {
  en: {
    "Welcome to our website": "Welcome to our website",
    "User Profile": "User Profile",
    "Sign Out": "Sign Out",
  },
  "zh-CN": {
    "Welcome to our website": "æ¬¢è¿æ¥åˆ°æˆ‘ä»¬çš„ç½‘ç«™",
    "User Profile": "ç”¨æˆ·èµ„æ–™",
    "Sign Out": "é€€å‡ºç™»å½•",
  },
  "zh-TC": {
    "Welcome to our website": "æ­¡è¿ä¾†åˆ°æˆ‘å€‘çš„ç¶²ç«™",
    "User Profile": "ç”¨æˆ¶è³‡æ–™",
    "Sign Out": "é€€å‡ºç™»éŒ„",
  },
};

export default translations;
```

### å®Œæ•´è®°å½•æ ¼å¼

```json
{
  "src/components/Header": {
    "Welcome to our website": {
      "en": "Welcome to our website",
      "zh-CN": "æ¬¢è¿æ¥åˆ°æˆ‘ä»¬çš„ç½‘ç«™",
      "zh-TC": "æ­¡è¿ä¾†åˆ°æˆ‘å€‘çš„ç¶²ç«™",
      "_lastUsed": 1704067200000
    },
    "User Profile": {
      "en": "User Profile",
      "zh-CN": "ç”¨æˆ·èµ„æ–™",
      "zh-TC": "ç”¨æˆ¶è³‡æ–™",
      "_lastUsed": 1704067200000
    }
  }
}
```

## ğŸ§¹ æ™ºèƒ½é”®ç®¡ç†

### æ— ç”¨é”®æ£€æµ‹

å·¥å…·æä¾›ä¸¤ç§æ£€æµ‹æ¨¡å¼ï¼š

#### 1. å¼•ç”¨æ£€æµ‹æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰

```javascript
// é…ç½®
module.exports = {
  // ä¸è®¾ç½® keyExpirationDays æˆ–è®¾ç½®ä¸º undefined
  keyExpirationDays: undefined,
};
```

#### 2. æ—¶é—´æ£€æµ‹æ¨¡å¼

```javascript
// é…ç½®
module.exports = {
  keyExpirationDays: 30, // 30å¤©æœªä½¿ç”¨çš„é”®è§†ä¸ºè¿‡æœŸ
};
```

### å¼ºåˆ¶ä¿ç•™é…ç½®

```javascript
// æ•°ç»„æ ¼å¼ï¼ˆå…¨å±€ä¿ç•™ï¼‰
forceKeepKeys: ["system.error", "api.timeout"]

// å¯¹è±¡æ ¼å¼ï¼ˆæŒ‰æ¨¡å—ä¿ç•™ï¼‰
forceKeepKeys: {
  "src/components/ErrorBoundary": ["error.network", "error.unknown"],
  "src/utils/api": ["api.timeout", "api.retry"],
  "src/pages/admin": ["admin.*"]  // æ”¯æŒé€šé…ç¬¦
}
```

### åˆ é™¤é¢„è§ˆ

åˆ é™¤å‰ä¼šç”Ÿæˆè¯¦ç»†çš„é¢„è§ˆæ–‡ä»¶ï¼š

```json
{
  "timestamp": "2024-01-15T10:30:00.000Z",
  "totalKeysToDelete": 5,
  "keysToDelete": [
    {
      "key": "Old unused message",
      "translations": {
        "en": "Old unused message",
        "zh-CN": "æ—§çš„æœªä½¿ç”¨æ¶ˆæ¯"
      },
      "reason": "æœªåœ¨ä»£ç ä¸­æ‰¾åˆ°å¼•ç”¨"
    }
  ],
  "affectedLanguages": ["en", "zh-CN"]
}
```

## ğŸ“Š Google Sheets é›†æˆ

### è®¾ç½®æ­¥éª¤

1. **åˆ›å»º Google Cloud é¡¹ç›®**

   - è®¿é—® [Google Cloud Console](https://console.cloud.google.com/)
   - åˆ›å»ºæ–°é¡¹ç›®æˆ–é€‰æ‹©ç°æœ‰é¡¹ç›®

2. **å¯ç”¨ Google Sheets API**

   - åœ¨ API åº“ä¸­æœç´¢å¹¶å¯ç”¨ "Google Sheets API"

3. **åˆ›å»ºæœåŠ¡è´¦å·**

   - åˆ›å»ºæœåŠ¡è´¦å·å¹¶ä¸‹è½½ JSON å¯†é’¥æ–‡ä»¶
   - å°†æ–‡ä»¶ä¿å­˜ä¸º `serviceAccountKeyFile.json`

4. **å…±äº« Google Sheets**
   - å°†æœåŠ¡è´¦å·é‚®ç®±æ·»åŠ åˆ° Google Sheets çš„ç¼–è¾‘è€…åˆ—è¡¨

### åŒæ­¥æœºåˆ¶

```mermaid
sequenceDiagram
    participant L as æœ¬åœ°å·¥å…·
    participant S as Google Sheets

    L->>S: 1. æ‹‰å–è¿œç¨‹ç¿»è¯‘æ•°æ®
    L->>L: 2. åˆå¹¶åˆ°æœ¬åœ°å®Œæ•´è®°å½•
    L->>L: 3. æ‰«æå’Œè½¬æ¢ä»£ç 
    L->>L: 4. æ£€æµ‹å’Œåˆ é™¤æ— ç”¨é”®
    L->>L: 5. ç”Ÿæˆæ¨¡å—åŒ–ç¿»è¯‘æ–‡ä»¶
    L->>S: 6. æ¨é€æ›´æ–°åˆ°è¿œç¨‹
```

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### å®‰è£…

```bash
# å…¨å±€å®‰è£…
npm install -g i18n-google

# é¡¹ç›®å®‰è£…
npm install i18n-google --save-dev
```

### å‘½ä»¤è¡Œä½¿ç”¨

```bash
# ç›´æ¥è¿è¡Œï¼ˆå…¨å±€å®‰è£…åï¼‰
i18n-google

# é€šè¿‡ npx è¿è¡Œ
npx i18n-google

# é¡¹ç›®è„šæœ¬
npm run scan
```

### ç¼–ç¨‹ä½¿ç”¨

```typescript
import { I18nScanner } from "i18n-google";
import config from "./i18n.config.js";

const scanner = new I18nScanner(config);

async function runScan() {
  try {
    await scanner.scan();
    console.log("æ‰«æå®Œæˆï¼");
  } catch (error) {
    console.error("æ‰«æå¤±è´¥:", error);
  }
}

runScan();
```

## ğŸ¯ å‰ç«¯é›†æˆ

### I18n å·¥å…·ç±»

```typescript
// src/utils/i18n.ts
interface ModuleTranslations {
  [locale: string]: { [key: string]: string };
}

class I18nUtil {
  static getCurrentLocale(): string {
    if (typeof window === "undefined") return "en";
    const params = new URLSearchParams(window.location.search);
    return localStorage.getItem("locale") || params.get("lang") || "en";
  }

  static createScoped(translations: ModuleTranslations) {
    const locale = this.getCurrentLocale();
    return {
      t: (key: string, params?: Record<string, any>) => {
        let text = translations[locale]?.[key] || key;

        // å¤„ç†å‚æ•°æ’å€¼
        if (params) {
          Object.entries(params).forEach(([key, value]) => {
            text = text.replace(new RegExp(`%{${key}}`, "g"), String(value));
          });
        }

        return text;
      },
    };
  }

  static switchLocale(newLocale: string): void {
    localStorage.setItem("locale", newLocale);
    const url = new URL(window.location.href);
    url.searchParams.set("lang", newLocale);
    window.location.href = url.toString();
  }
}

export { I18nUtil };
```

### ç»„ä»¶ä½¿ç”¨ç¤ºä¾‹

```typescript
// src/components/Header.tsx
import React from "react";
import { I18nUtil } from "@/utils/i18n";
import translations from "@/translate/src/components/Header";

function Header() {
  const I18n = I18nUtil.createScoped(translations);

  return (
    <header>
      <h1>{I18n.t("Welcome to our website")}</h1>
      <nav>
        <a href="/profile">{I18n.t("User Profile")}</a>
        <button onClick={() => signOut()}>{I18n.t("Sign Out")}</button>
      </nav>
    </header>
  );
}

export default Header;
```

### è¯­è¨€åˆ‡æ¢ç»„ä»¶

```typescript
// src/components/LanguageSwitcher.tsx
import React from "react";
import { I18nUtil } from "@/utils/i18n";

const languages = [
  { code: "en", name: "English" },
  { code: "zh-CN", name: "ä¸­æ–‡ï¼ˆç®€ä½“ï¼‰" },
  { code: "zh-TC", name: "ä¸­æ–‡ï¼ˆç¹é«”ï¼‰" },
  { code: "ko", name: "í•œêµ­ì–´" },
];

function LanguageSwitcher() {
  const currentLocale = I18nUtil.getCurrentLocale();

  return (
    <select
      value={currentLocale}
      onChange={(e) => I18nUtil.switchLocale(e.target.value)}
    >
      {languages.map((lang) => (
        <option key={lang.code} value={lang.code}>
          {lang.name}
        </option>
      ))}
    </select>
  );
}

export default LanguageSwitcher;
```

## ğŸ§ª æµ‹è¯•å’Œå¼€å‘

### è¿è¡Œæµ‹è¯•

```bash
npm test
```

### å¼€å‘æ¨¡å¼

```bash
npm run dev
```

### æ„å»ºé¡¹ç›®

```bash
npm run build
```

### ç¤ºä¾‹é¡¹ç›®

é¡¹ç›®åŒ…å«ä¸¤ä¸ªå®Œæ•´çš„ç¤ºä¾‹ï¼š

- `demo/nextjs/` - Next.js é›†æˆç¤ºä¾‹
- `demo/vite/` - Vite + React é›†æˆç¤ºä¾‹

## ğŸ“ˆ æœ€ä½³å®è·µ

### 1. ç¿»è¯‘é”®å‘½å

```javascript
// âœ… æ¨èï¼šä½¿ç”¨æ¸…æ™°çš„è‹±æ–‡æè¿°
"Welcome to our platform";
"User profile updated successfully";
"Please enter a valid email address";

// âŒ é¿å…ï¼šä½¿ç”¨ç¼©å†™æˆ–ä¸æ¸…æ™°çš„æè¿°
"WelcomeMsg";
"UpSuccess";
"EmailErr";
```

### 2. æ¨¡å—åŒ–ç»„ç»‡

```
// âœ… æ¨èï¼šæŒ‰åŠŸèƒ½æ¨¡å—ç»„ç»‡
src/translate/
â”œâ”€â”€ src/components/auth/     # è®¤è¯ç›¸å…³ç»„ä»¶
â”œâ”€â”€ src/components/profile/  # ç”¨æˆ·èµ„æ–™ç›¸å…³
â”œâ”€â”€ src/pages/dashboard/     # ä»ªè¡¨æ¿é¡µé¢
â””â”€â”€ src/utils/validation/    # éªŒè¯å·¥å…·

// âŒ é¿å…ï¼šæ‰€æœ‰ç¿»è¯‘æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶
src/translate/all-translations.ts
```

### 3. å¼ºåˆ¶ä¿ç•™é…ç½®

```javascript
// âœ… æ¨èï¼šæŒ‰æ¨¡å—ç²¾ç¡®é…ç½®
forceKeepKeys: {
  "src/components/ErrorBoundary": ["error.*"],
  "src/utils/api": ["api.timeout", "api.retry"],
  "src/config/constants": ["app.name", "app.version"]
}

// âŒ é¿å…ï¼šå…¨å±€ä¿ç•™è¿‡å¤šé”®
forceKeepKeys: ["error.*", "api.*", "system.*", "app.*"]
```

### 4. æ—¥å¿—çº§åˆ«é€‰æ‹©

```javascript
// å¼€å‘ç¯å¢ƒï¼šè¯¦ç»†æ—¥å¿—
logLevel: "verbose";

// ç”Ÿäº§ç¯å¢ƒï¼šæ ‡å‡†æ—¥å¿—
logLevel: "normal";

// CI/CDï¼šé™é»˜æ¨¡å¼
logLevel: "silent";
```

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **Google Sheets åŒæ­¥å¤±è´¥**

   - æ£€æŸ¥æœåŠ¡è´¦å·æƒé™
   - ç¡®è®¤ API å¯†é’¥æœ‰æ•ˆæ€§
   - éªŒè¯ spreadsheetId æ­£ç¡®æ€§

2. **ç¿»è¯‘æ–‡ä»¶æœªç”Ÿæˆ**

   - æ£€æŸ¥ outputDir æƒé™
   - ç¡®è®¤é…ç½®æ–‡ä»¶æ ¼å¼æ­£ç¡®
   - æŸ¥çœ‹è¯¦ç»†æ—¥å¿—è¾“å‡º

3. **ä»£ç è½¬æ¢å¼‚å¸¸**
   - æ£€æŸ¥æ–‡ä»¶ç¼–ç æ ¼å¼
   - ç¡®è®¤è¯­æ³•æ²¡æœ‰é”™è¯¯
   - æŸ¥çœ‹ AST è§£ææ—¥å¿—

### è°ƒè¯•æŠ€å·§

```bash
# å¯ç”¨è¯¦ç»†æ—¥å¿—
echo 'module.exports = { ...config, logLevel: "verbose" }' > i18n.config.js

# æŸ¥çœ‹æ‰«æè¿‡ç¨‹
npx i18n-google 2>&1 | tee scan.log

# æ£€æŸ¥ç”Ÿæˆçš„æ–‡ä»¶
find ./src/translate -name "*.ts" -exec echo "=== {} ===" \; -exec cat {} \;
```

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

### å¼€å‘æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. æ¨é€åˆ°åˆ†æ”¯
5. åˆ›å»º Pull Request

## ğŸ“ æ”¯æŒ

å¦‚æœæ‚¨åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œè¯·ï¼š

1. æŸ¥çœ‹[ç¤ºä¾‹é¡¹ç›®](./demo/)
2. æ£€æŸ¥[é…ç½®æ–‡æ¡£](#-é…ç½®è¯´æ˜)
3. æäº¤ [Issue](https://github.com/947776795/i18n-google/issues)

---

![CodeRabbit](https://img.shields.io/coderabbit/prs/github/947776795/i18n-google?utm_source=oss&utm_medium=github&utm_campaign=947776795%2Fi18n-google&labelColor=171717&color=FF570A&link=https%3A%2F%2Fcoderabbit.ai&label=CodeRabbit+Reviews)
